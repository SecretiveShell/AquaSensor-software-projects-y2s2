{% extends "base.html" %}
{% block title %}AquaSensor{% endblock %}

{% block contentHead %}
<script defer>
  async function isLoggedIn() {
    const token = window.sessionStorage["AquaSensorToken"];
    const response = await fetch("/api/v1/auth/me", {
      headers: {
        Accept: "application/json",
        "AquaSensor-Login-Token": token,
      },
    });
    const data = await response.json();
    return data && data.email;
  }

  document.addEventListener("DOMContentLoaded", async () => {
    const loggedInView = document.getElementById("logged-in");
    const loggedOutView = document.getElementById("logged-out");

    const isLogged = await isLoggedIn();
    if (isLogged) {
      loggedInView.style.display = "block";
      loggedOutView.style.display = "none";
    } else {
      loggedInView.style.display = "none";
      loggedOutView.style.display = "block";
    }
  });
</script>

<style>
  #here {
    font-family: Arial, sans-serif;
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  #here h3 {
    color: #333;
    font-size: 24px;
    margin-bottom: 20px;
    border-bottom: 2px solid #eee;
    padding-bottom: 10px;
    width: 100%;
    text-align: left;
  }

  #datalist {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 30px;
    width: 100%;
  }

  #datalist > div {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    padding: 20px;
    transition: transform 0.3s ease;
  }

  #datalist > div:hover {
    transform: translateY(-5px);
  }

  #datalist h4 {
    color: #2c3e50;
    font-size: 18px;
    margin-bottom: 10px;
  }

  #datalist h4 a {
    color: inherit;
    text-decoration: none;
  }

  #datalist h4 a:hover {
    color: #3498db;
    text-decoration: underline;
  }

  #datalist p {
    color: #666;
    line-height: 1.5;
    margin-bottom: 15px;
    word-wrap: break-word;
  }

  #datalist img {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
    margin-top: 10px;
  }

  .auth-link {
    display: inline-block;
    margin-right: 15px;
    color: #3498db;
    text-decoration: none;
    padding: 8px 15px;
    border: 1px solid #3498db;
    border-radius: 4px;
  }

  .auth-link:hover {
    background-color: #3498db;
    color: white;
  }
</style>
{% endblock %}

{% block content %}
<div id="main">
  <div id="content">
    <div id="here">
      <div id="logged-in" style="display: none;">
        <h3>Data Correlation Tools:</h3>
        <div id="datalist">
          <div>
            <h4><a href="/studio">Sensor Map Studio</a></h4>
            <p>An interactive sensor map and visualization tool showing both real time and historical data.</p>
            <img src="static/screenshots/studio.webp" alt="Map with a highlighted river section" />
          </div>
          <div>
            <h4><a href="#">TBD</a></h4>
            <p>Placeholder for future feature</p>
          </div>
          <div>
            <h4><a href="https://chatgpt.com/g/g-67b85ae105b48191ba83193839c0a47d-aquasensorgpt">AquasensorGPT</a></h4>
            <p>An interactive chatbot that can answer questions about the river and its surrounding environment using live sensor data.</p>
          </div>
        </div>
      </div>

      <div id="logged-out" style="display: none;">
        <p>
          The AquaSensor solution provides low cost, real-time river quality
          monitoring, which ensures legal compliance, saves money and protects the
          environment.
        </p>
        <a class="auth-link" href="/login">Sign in</a>
        <a class="auth-link" href="/register">Register</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
