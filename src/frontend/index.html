{% extends "base.html" %} {% block title %}AquaSensor{% endblock %}

{% block contentHead %}
<script>
	async function _isLogged(){
		let tok=window.sessionStorage["AquaSensorToken"];
		return await fetch(
			"{{ base_url }}" + "/api/v1/auth/me",
			{headers: {
				'Accept': 'application/json',
				'AquaSensor-Login-Token': tok
			}}).then(
				(response)=>response.json()).then(
					(response)=>{return ('email' in response)});
	}
</script>

<style>
#datalist div{
	display:inline;
}
</style>
{% endblock %}

{% block content %}
    <div id="main">
      <p>
        The AquaSensor solution provides low cost, real-time river quality
        monitoring, which ensures legal compliance, saves money and protects the
        environment.
      </p>
      <div id="here">
      </div>
      <script>
	      _isLogged().then((value)=>{
		      var writeto=document.getElementById('here');
		      if(value){
			      writeto.innerHTML="<h3>Data Correlation Tools:</h3><span id=\"datalist\"><div></div><div></div><div></div></span>";
		      }else{
			      writeto.innerHTML="<a href='{{ base_url }}/login'><p>Sign in</p></a><a href='{{ base_url }}/register'><p>Register</p></a>";
		      }
	      });
      </script>
    </div>
{% endblock %}
